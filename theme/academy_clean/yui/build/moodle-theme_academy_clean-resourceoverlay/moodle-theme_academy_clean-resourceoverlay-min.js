YUI.add("moodle-theme_academy_clean-resourceoverlay",function(e,t){function u(t){var n=t.get("boundingBox"),r=n.get("winHeight"),i=n.get("winWidth"),s=0,o,u,a,f,l,c=t.bodyNode;o=c.get("maxheight"),r<=o&&(r<=c.get("minheight")?o=c.get("minheight"):o=r),o>c.get("minheight")?(n.setStyle("position","fixed"),e.UA.ie>0?e.one("html").setStyle("overflow","hidden"):e.one("body").setStyle("overflow","hidden")):(n.setStyle("position","absolute"),s=e.one("window").get("scrollTop"),e.UA.ie>0?e.one("html").setStyle("overflow",this.initialoverflow):e.one("body").setStyle("overflow",this.initialoverflow)),u=o,o-=110,c.setStyle("maxHeight",o+"px"),dialogueheight=n.getStyle("height"),dialogueheight.match(/.*px$/)?dialogueheight=dialogueheight.replace(/px$/,""):dialogueheight=u,dialogueheight<t.get("baseheight")&&(dialogueheight=t.get("baseheight"),c.setStyle("height",dialogueheight+"px")),a=Math.max(12,(r-dialogueheight)/2)+s,n.setStyle("top",a+"px"),f=n.get("offsetWidth"),l=(i-f)/2,n.setStyle("left",l+"px")}function a(e){e.getAttribute("onclick").length>2&&e.append("&nbspPOPUP")}function f(e){return e.getAttribute("onclick").length>2&&e.test(r)?!0:!1}function l(e,t){var n,r;return n=new RegExp(t+"=([0-9]+)","i"),r=e.match(n),r===null?null:r[1]}var n="Academy theme resource overlay",r=".activity.resource .activityinstance a, .activity.url .activityinstance a",i="overlay",s=12,o;o=function(){o.superclass.constructor.apply(this,arguments)},e.extend(o,e.Base,{dialogue:null,initialoverflow:"",initializer:function(){var t=this,n=e.all(r).each(a);e.delegate("mousedown",function(n){n.preventDefault(),n.stopPropagation();var r=this.getAttribute("onclick"),o=l(r,"width"),a=parseFloat(o)+parseFloat(s*2),f=l(r,"height"),c=this.getAttribute("href")+"&redirect=1",h="",p=e.Node.create('<iframe class="'+i+'" width="'+o+'" height="'+f+'" src="'+c+'" scrolling="no"></iframe>'),d=new M.core.dialogue({headerContent:h,bodyContent:p,lightbox:!0,width:a,height:"auto",centered:!0,constrain:!0,draggable:!1,zindex:100,shim:!0,closeButtonTitle:this.get("closeButtonTitle")});d.get("buttons").header[0].on("click",function(t){var n=!0;d.destroy(n),e.UA.ie>0?e.one("html").setStyle("overflow",this.initialoverflow):e.one("body").setStyle("overflow",this.initialoverflow),this.container.detachAll()}),d.get("maskNode").on("click",function(t){setTimeout(function(){var t=!0;d.destroy(t),e.UA.ie>0?e.one("html").setStyle("overflow",this.initialoverflow):e.one("body").setStyle("overflow",this.initialoverflow),this.container.detachAll()},50)}),t.dialog=d,d.render(e.one(document.body)),u(d),e.UA.ie>0?this.initialoverflow=e.one("html").getStyle("overflow"):this.initialoverflow=e.one("body").getStyle("overflow"),thisevent=e.one("document").on("orientationchange",function(){u(d)},this),thisevent=e.one("window").on("resize",function(){u(d)},this)},e.one("#page"),f)}},{NAME:n,ATTRS:{name:{validator:e.Lang.isString,value:"resourceoverlay"},minheight:{value:300},baseheight:{value:400},maxheight:{value:660}}}),M.theme_academy_clean=M.theme_academy_clean||{},M.theme_academy_clean.resourceoverlay={init:function(e){return new o(e)}}},"@VERSION@",{requires:["base","node","event-delegate","moodle-core-dialogue","moodle-core-notification"]});
